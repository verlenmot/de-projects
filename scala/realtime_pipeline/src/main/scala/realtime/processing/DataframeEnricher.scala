package realtime.processing

import org.apache.spark.sql.DataFrame
import org.apache.spark.sql.functions._

object DataframeEnricher {

  def requestTimeAdd(dataFrame: DataFrame, requestTime: String): DataFrame = {

    val adjustedTime: String = requestTime.drop(5)
    val enrichedDataFrame: DataFrame = dataFrame.withColumn("timestamp", to_timestamp(lit(adjustedTime), "dd MMM yyyy HH:mm:ss z"))
    enrichedDataFrame
  }

  def weatherFullDayTranslate(codeValue: String): String = {
    codeValue match {
      case "0" => "unknown"
      case "1000" => "Clear, Sunny"
      case "1100" => "Mostly Clear"
      case "1101" => "Partly Cloudy"
      case "1102" => "Mostly Cloudy"
      case "1001" => "Cloudy"
      case "1103" => "Partly Cloudy and Mostly Clear"
      case "2100" => "Light Fog"
      case "2101" => "Mostly Clear and Light Fog"
      case "2102" => "Partly Cloudy and Light Fog"
      case "2103" => "Mostly Cloudy and Light Fog"
      case "2106" => "Mostly Clear and Fog"
      case "2107" => "Partly Cloudy and Fog"
      case "2108" => "Mostly Cloudy and Fog"
      case "2000" => "Fog"
      case "4204" => "Partly Cloudy and Drizzle"
      case "4203" => "Mostly Clear and Drizzle"
      case "4205" => "Mostly Cloudy and Drizzle"
      case "4000" => "Drizzle"
      case "4200" => "Light Rain"
      case "4213" => "Mostly Clear and Light Rain"
      case "4214" => "Partly Cloudy and Light Rain"
      case "4215" => "Mostly Cloudy and Light Rain"
      case "4209" => "Mostly Clear and Rain"
      case "4208" => "Partly Cloudy and Rain"
      case "4210" => "Mostly Cloudy and Rain"
      case "4001" => "Rain"
      case "4211" => "Mostly Clear and Heavy Rain"
      case "4202" => "Partly Cloudy and Heavy Rain"
      case "4212" => "Mostly Cloudy and Heavy Rain"
      case "4201" => "Heavy Rain"
      case "5115" => "Mostly Clear and Flurries"
      case "5116" => "Partly Cloudy and Flurries"
      case "5117" => "Mostly Cloudy and Flurries"
      case "5001" => "Flurries"
      case "5100" => "Light Snow"
      case "5102" => "Mostly Clear and Light Snow"
      case "5103" => "Partly Cloudy and Light Snow"
      case "5104" => "Mostly Cloudy and Light Snow"
      case "5122" => "Drizzle and Light Snow"
      case "5105" => "Mostly Clear and Snow"
      case "5106" => "Partly Cloudy and Snow"
      case "5107" => "Mostly Cloudy and Snow"
      case "5000" => "Snow"
      case "5101" => "Heavy Snow"
      case "5119" => "Mostly Clear and Heavy Snow"
      case "5120" => "Partly Cloudy and Heavy Snow"
      case "5121" => "Mostly Cloudy and Heavy Snow"
      case "5110" => "Drizzle and Snow"
      case "5108" => "Rain and Snow"
      case "5114" => "Snow and Freezing Rain"
      case "5112" => "Snow and Ice Pellets"
      case "6000" => "Freezing Drizzle"
      case "6003" => "Mostly Clear and Freezing drizzle"
      case "6002" => "Partly Cloudy and Freezing drizzle"
      case "6004" => "Mostly Cloudy and Freezing drizzle"
      case "6204" => "Drizzle and Freezing Drizzle"
      case "6206" => "Light Rain and Freezing Drizzle"
      case "6205" => "Mostly Clear and Light Freezing Rain"
      case "6203" => "Partly Cloudy and Light Freezing Rain"
      case "6209" => "Mostly Cloudy and Light Freezing Rain"
      case "6200" => "Light Freezing Rain"
      case "6213" => "Mostly Clear and Freezing Rain"
      case "6214" => "Partly Cloudy and Freezing Rain"
      case "6215" => "Mostly Cloudy and Freezing Rain"
      case "6001" => "Freezing Rain"
      case "6212" => "Drizzle and Freezing Rain"
      case "6220" => "Light Rain and Freezing Rain"
      case "6222" => "Rain and Freezing Rain"
      case "6207" => "Mostly Clear and Heavy Freezing Rain"
      case "6202" => "Partly Cloudy and Heavy Freezing Rain"
      case "6208" => "Mostly Cloudy and Heavy Freezing Rain"
      case "6201" => "Heavy Freezing Rain"
      case "7110" => "Mostly Clear and Light Ice Pellets"
      case "7111" => "Partly Cloudy and Light Ice Pellets"
      case "7112" => "Mostly Cloudy and Light Ice Pellets"
      case "7102" => "Light Ice Pellets"
      case "7108" => "Mostly Clear and Ice Pellets"
      case "7107" => "Partly Cloudy and Ice Pellets"
      case "7109" => "Mostly Cloudy and Ice Pellets"
      case "7000" => "Ice Pellets"
      case "7105" => "Drizzle and Ice Pellets"
      case "7106" => "Freezing Rain and Ice Pellets"
      case "7115" => "Light Rain and Ice Pellets"
      case "7117" => "Rain and Ice Pellets"
      case "7103" => "Freezing Rain and Heavy Ice Pellets"
      case "7113" => "Mostly Clear and Heavy Ice Pellets"
      case "7114" => "Partly Cloudy and Heavy Ice Pellets"
      case "7116" => "Mostly Cloudy and Heavy Ice Pellets"
      case "7101" => "Heavy Ice Pellets"
      case "8001" => "Mostly Clear and Thunderstorm"
      case "8003" => "Partly Cloudy and Thunderstorm"
      case "8002" => "Mostly Cloudy and Thunderstorm"
      case "8000" => "Thunderstorm"
    }
  }

  def weatherDayTranslate(codeValue: String): String = {
    codeValue match {
      case "0" => "Unknown"
      case "10000" => "Clear, Sunny"
      case "11000" => "Mostly Clear"
      case "11010" => "Partly Cloudy"
      case "11020" => "Mostly Cloudy"
      case "10010" => "Cloudy"
      case "11030" => "Partly Cloudy and Mostly Clear"
      case "21000" => "Light Fog"
      case "21010" => "Mostly Clear and Light Fog"
      case "21020" => "Partly Cloudy and Light Fog"
      case "21030" => "Mostly Cloudy and Light Fog"
      case "21060" => "Mostly Clear and Fog"
      case "21070" => "Partly Cloudy and Fog"
      case "21080" => "Mostly Cloudy and Fog"
      case "20000" => "Fog"
      case "42040" => "Partly Cloudy and Drizzle"
      case "42030" => "Mostly Clear and Drizzle"
      case "42050" => "Mostly Cloudy and Drizzle"
      case "40000" => "Drizzle"
      case "42000" => "Light Rain"
      case "42130" => "Mostly Clear and Light Rain"
      case "42140" => "Partly Cloudy and Light Rain"
      case "42150" => "Mostly Cloudy and Light Rain"
      case "42090" => "Mostly Clear and Rain"
      case "42080" => "Partly Cloudy and Rain"
      case "42100" => "Mostly Cloudy and Rain"
      case "40010" => "Rain"
      case "42110" => "Mostly Clear and Heavy Rain"
      case "42020" => "Partly Cloudy and Heavy Rain"
      case "42120" => "Mostly Cloudy and Heavy Rain"
      case "42010" => "Heavy Rain"
      case "51150" => "Mostly Clear and Flurries"
      case "51160" => "Partly Cloudy and Flurries"
      case "51170" => "Mostly Cloudy and Flurries"
      case "50010" => "Flurries"
      case "51000" => "Light Snow"
      case "51020" => "Mostly Clear and Light Snow"
      case "51030" => "Partly Cloudy and Light Snow"
      case "51040" => "Mostly Cloudy and Light Snow"
      case "51220" => "Drizzle and Light Snow"
      case "51050" => "Mostly Clear and Snow"
      case "51060" => "Partly Cloudy and Snow"
      case "51070" => "Mostly Cloudy and Snow"
      case "50000" => "Snow"
      case "51010" => "Heavy Snow"
      case "51190" => "Mostly Clear and Heavy Snow"
      case "51200" => "Partly Cloudy and Heavy Snow"
      case "51210" => "Mostly Cloudy and Heavy Snow"
      case "51100" => "Drizzle and Snow"
      case "51080" => "Rain and Snow"
      case "51140" => "Snow and Freezing Rain"
      case "51120" => "Snow and Ice Pellets"
      case "60000" => "Freezing Drizzle"
      case "60030" => "Mostly Clear and Freezing drizzle"
      case "60020" => "Partly Cloudy and Freezing drizzle"
      case "60040" => "Mostly Cloudy and Freezing drizzle"
      case "62040" => "Drizzle and Freezing Drizzle"
      case "62060" => "Light Rain and Freezing Drizzle"
      case "62050" => "Mostly Clear and Light Freezing Rain"
      case "62030" => "Partly Cloudy and Light Freezing Rain"
      case "62090" => "Mostly Cloudy and Light Freezing Rain"
      case "62000" => "Light Freezing Rain"
      case "62130" => "Mostly Clear and Freezing Rain"
      case "62140" => "Partly Cloudy and Freezing Rain"
      case "62150" => "Mostly Cloudy and Freezing Rain"
      case "60010" => "Freezing Rain"
      case "62120" => "Drizzle and Freezing Rain"
      case "62200" => "Light Rain and Freezing Rain"
      case "62220" => "Rain and Freezing Rain"
      case "62070" => "Mostly Clear and Heavy Freezing Rain"
      case "62020" => "Partly Cloudy and Heavy Freezing Rain"
      case "62080" => "Mostly Cloudy and Heavy Freezing Rain"
      case "62010" => "Heavy Freezing Rain"
      case "71100" => "Mostly Clear and Light Ice Pellets"
      case "71110" => "Partly Cloudy and Light Ice Pellets"
      case "71120" => "Mostly Cloudy and Light Ice Pellets"
      case "71020" => "Light Ice Pellets"
      case "71080" => "Mostly Clear and Ice Pellets"
      case "71070" => "Partly Cloudy and Ice Pellets"
      case "71090" => "Mostly Cloudy and Ice Pellets"
      case "70000" => "Ice Pellets"
      case "71050" => "Drizzle and Ice Pellets"
      case "71060" => "Freezing Rain and Ice Pellets"
      case "71150" => "Light Rain and Ice Pellets"
      case "71170" => "Rain and Ice Pellets"
      case "71030" => "Freezing Rain and Heavy Ice Pellets"
      case "71130" => "Mostly Clear and Heavy Ice Pellets"
      case "71140" => "Partly Cloudy and Heavy Ice Pellets"
      case "71160" => "Mostly Cloudy and Heavy Ice Pellets"
      case "71010" => "Heavy Ice Pellets"
      case "80010" => "Mostly Clear and Thunderstorm"
      case "80030" => "Partly Cloudy and Thunderstorm"
      case "80020" => "Mostly Cloudy and Thunderstorm"
      case "80000" => "Thunderstorm"
    }
  }

  def weatherNightTranslate(codeValue: String): String = {
    codeValue match {
      case "0" => "Unknown"
      case "10001" => "Clear"
      case "11001" => "Mostly Clear"
      case "11011" => "Partly Cloudy"
      case "11021" => "Mostly Cloudy"
      case "10011" => "Cloudy"
      case "11031" => "Partly Cloudy and Mostly Clear"
      case "21001" => "Light Fog"
      case "21011" => "Mostly Clear and Light Fog"
      case "21021" => "Partly Cloudy and Light Fog"
      case "21031" => "Mostly Cloudy and Light Fog"
      case "21061" => "Mostly Clear and Fog"
      case "21071" => "Partly Cloudy and Fog"
      case "21081" => "Mostly Cloudy and Fog"
      case "20001" => "Fog"
      case "42041" => "Partly Cloudy and Drizzle"
      case "42031" => "Mostly Clear and Drizzle"
      case "42051" => "Mostly Cloudy and Drizzle"
      case "40001" => "Drizzle"
      case "42001" => "Light Rain"
      case "42131" => "Mostly Clear and Light Rain"
      case "42141" => "Partly Cloudy and Light Rain"
      case "42151" => "Mostly Cloudy and Light Rain"
      case "42091" => "Mostly Clear and Rain"
      case "42081" => "Partly Cloudy and Rain"
      case "42101" => "Mostly Cloudy and Rain"
      case "40011" => "Rain"
      case "42111" => "Mostly Clear and Heavy Rain"
      case "42021" => "Partly Cloudy and Heavy Rain"
      case "42121" => "Mostly Cloudy and Heavy Rain"
      case "42011" => "Heavy Rain"
      case "51151" => "Mostly Clear and Flurries"
      case "51161" => "Partly Cloudy and Flurries"
      case "51171" => "Mostly Cloudy and Flurries"
      case "50011" => "Flurries"
      case "51001" => "Light Snow"
      case "51021" => "Mostly Clear and Light Snow"
      case "51031" => "Partly Cloudy and Light Snow"
      case "51041" => "Mostly Cloudy and Light Snow"
      case "51221" => "Drizzle and Light Snow"
      case "51051" => "Mostly Clear and Snow"
      case "51061" => "Partly Cloudy and Snow"
      case "51071" => "Mostly Cloudy and Snow"
      case "50001" => "Snow"
      case "51011" => "Heavy Snow"
      case "51191" => "Mostly Clear and Heavy Snow"
      case "51201" => "Partly Cloudy and Heavy Snow"
      case "51211" => "Mostly Cloudy and Heavy Snow"
      case "51101" => "Drizzle and Snow"
      case "51081" => "Rain and Snow"
      case "51141" => "Snow and Freezing Rain"
      case "51121" => "Snow and Ice Pellets"
      case "60001" => "Freezing Drizzle"
      case "60031" => "Mostly Clear and Freezing drizzle"
      case "60021" => "Partly Cloudy and Freezing drizzle"
      case "60041" => "Mostly Cloudy and Freezing drizzle"
      case "62041" => "Drizzle and Freezing Drizzle"
      case "62061" => "Light Rain and Freezing Drizzle"
      case "62051" => "Mostly Clear and Light Freezing Rain"
      case "62031" => "Partly cloudy and Light Freezing Rain"
      case "62091" => "Mostly Cloudy and Light Freezing Rain"
      case "62001" => "Light Freezing Rain"
      case "62131" => "Mostly Clear and Freezing Rain"
      case "62141" => "Partly Cloudy and Freezing Rain"
      case "62151" => "Mostly Cloudy and Freezing Rain"
      case "60011" => "Freezing Rain"
      case "62121" => "Drizzle and Freezing Rain"
      case "62201" => "Light Rain and Freezing Rain"
      case "62221" => "Rain and Freezing Rain"
      case "62071" => "Mostly Clear and Heavy Freezing Rain"
      case "62021" => "Partly Cloudy and Heavy Freezing Rain"
      case "62081" => "Mostly Cloudy and Heavy Freezing Rain"
      case "62011" => "Heavy Freezing Rain"
      case "71101" => "Mostly Clear and Light Ice Pellets"
      case "71111" => "Partly Cloudy and Light Ice Pellets"
      case "71121" => "Mostly Cloudy and Light Ice Pellets"
      case "71021" => "Light Ice Pellets"
      case "71081" => "Mostly Clear and Ice Pellets"
      case "71071" => "Partly Cloudy and Ice Pellets"
      case "71091" => "Mostly Cloudy and Ice Pellets"
      case "70001" => "Ice Pellets"
      case "71051" => "Drizzle and Ice Pellets"
      case "71061" => "Freezing Rain and Ice Pellets"
      case "71151" => "Light Rain and Ice Pellets"
      case "71171" => "Rain and Ice Pellets"
      case "71031" => "Freezing Rain and Heavy Ice Pellets"
      case "71131" => "Mostly Clear and Heavy Ice Pellets"
      case "71141" => "Partly Cloudy and Heavy Ice Pellets"
      case "71161" => "Mostly Cloudy and Heavy Ice Pellets"
      case "71011" => "Heavy Ice Pellets"
      case "80011" => "Mostly Clear and Thunderstorm"
      case "80031" => "Partly Cloudy and Thunderstorm"
      case "80021" => "Mostly Cloudy and Thunderstorm"
      case "80001" => "Thunderstorm"
    }
  }

  val codeFullDayUDF = udf(weatherFullDayTranslate _)
  val codeDayUDF = udf(weatherDayTranslate _)
  val codeNightUDF = udf(weatherNightTranslate _)

  def weatherConditionTranslate(df: DataFrame, codeType: String): DataFrame = {
    codeType match {
      case "hour" => df.withColumn("weatherCondition", codeFullDayUDF(col("weatherCode")))
      case "day" => df.withColumn("weatherConditionMin", codeFullDayUDF(col("weatherCodeMin"))).
        withColumn("weatherConditionMax", codeFullDayUDF(col("weatherCodeMax")))
    }
  }
}